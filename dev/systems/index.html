<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Data structures for polynomial systems · Homotopy Continuation</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="Homotopy Continuation logo"/></a><h1>Homotopy Continuation</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Introduction</a></li><li><a class="toctext" href="../solving/">Solving general systems</a></li><li><a class="toctext" href="../monodromy/">Solving paremeterized systems with monodromy</a></li><li><a class="toctext" href="../sorting/">Sorting arrays of solutions</a></li><li><a class="toctext" href="../path_tracker/">PathTracker</a></li><li><a class="toctext" href="../core_tracker/">CoreTracker</a></li><li><a class="toctext" href="../newton/">Newton&#39;s method</a></li><li><a class="toctext" href="../homotopies/">Homotopies</a></li><li><a class="toctext" href="../predictors-correctors/">Predictors and correctors</a></li><li class="current"><a class="toctext" href>Data structures for polynomial systems</a><ul class="internal"><li><a class="toctext" href="#Default-systems-1">Default systems</a></li><li><a class="toctext" href="#Interface-for-custom-systems-1">Interface for custom systems</a></li></ul></li><li><a class="toctext" href="../norms_distances/">Norms and distances</a></li><li><a class="toctext" href="../reference/">Reference</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Data structures for polynomial systems</a></li></ul><a class="edit-page" href="https://github.com/JuliaHomotopyContinuation/HomotopyContinuation.jl/blob/master/docs/src/systems.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Data structures for polynomial systems</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Data-structures-for-polynomial-systems-1" href="#Data-structures-for-polynomial-systems-1">Data structures for polynomial systems</a></h1><p>Polynomial systems can be represented in numerous ways in a computer and each representation has certain tradeoffs. For our purposes the most important thing is that it is <em>fast</em> to evaluate the system. Therefore we automatically convert an input given by <a href="https://github.com/JuliaAlgebra/DynamicPolynomials.jl"><code>DynamicPolynomial</code></a>s to another representation more suitable for numerically evaluations. The default is currently <a href="#HomotopyContinuation.FPSystem"><code>FPSystem</code></a>.</p><h2><a class="nav-anchor" id="Default-systems-1" href="#Default-systems-1">Default systems</a></h2><p>We provide the following systems by default.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.FPSystem" href="#HomotopyContinuation.FPSystem"><code>HomotopyContinuation.FPSystem</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">FPSystem(polynomials, vars) &lt;: AbstractSystem</code></pre><p>Create a polynomial system using the <a href="https://github.com/JuliaAlgebra/FixedPolynomials.jl"><code>FixedPolynomials</code></a> package.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.SPSystem" href="#HomotopyContinuation.SPSystem"><code>HomotopyContinuation.SPSystem</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">SPSystem(polynomials, vars) &lt;: AbstractSystem</code></pre><p>Create a system using the <a href="https://github.com/JuliaAlgebra/StaticPolynomials.jl"><code>StaticPolynomials</code></a> package. Note that <code>StaticPolynomials</code> leverages Julias metaprogramming capabilities to automatically generate functions to evaluate the system and its Jacobian. These generated functions are <em>very fast</em> but at the cost of possibly large compile times. The compile time depends on the size of the support of the polynomial system. If you intend to solve a large system or you need to solve a system with the <em>same support</em> but different coefficients even large compile times can be worthwile. As a general rule of thumb this usually is twice as fast as solving the same system using <a href="#HomotopyContinuation.FPSystem"><code>FPSystem</code></a>.</p><p><strong>Example</strong></p><p>You can use <code>SPSystem</code> as follows with solve</p><pre><code class="language-julia">@polyvar x y
F = [x^2+3y^4-2, 2y^2+3x*y+4]
solve(F, system=SPSystem)</code></pre></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.FixedHomotopy" href="#HomotopyContinuation.FixedHomotopy"><code>HomotopyContinuation.FixedHomotopy</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">FixedHomotopy(H, t) &lt;: AbstractSystem</code></pre><p>Fix a homotopy <code>H(x,t)</code> at <code>t</code></p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.FixedParameterSystem" href="#HomotopyContinuation.FixedParameterSystem"><code>HomotopyContinuation.FixedParameterSystem</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">FixedParameterSystem(F, p) &lt;: AbstractSystem</code></pre><p>Fix a parameterized system <code>F(x; p)</code> at <code>p</code>, i.e., it is treated as a system without parameters.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.CompositionSystem" href="#HomotopyContinuation.CompositionSystem"><code>HomotopyContinuation.CompositionSystem</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">CompositionSystem(composition::Composition, systems_constructor) &lt;: AbstractSystem</code></pre><p>A system representing the composition of polynomial maps.</p></div></div></section><h2><a class="nav-anchor" id="Interface-for-custom-systems-1" href="#Interface-for-custom-systems-1">Interface for custom systems</a></h2><p>The great thing is that you are not limited to the systems provided by default. Maybe your polynomial system has a particular structure which you want to use to efficiently evaluate it. For this you can define your own homotopy by defining a struct with super type <a href="#HomotopyContinuation.AbstractSystem"><code>AbstractSystem</code></a>. For this the following interface has to be defined.</p><h3><a class="nav-anchor" id="Types-1" href="#Types-1">Types</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.AbstractSystem" href="#HomotopyContinuation.AbstractSystem"><code>HomotopyContinuation.AbstractSystem</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">AbstractSystem</code></pre><p>Representing a system of polynomials.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.AbstractSystemCache" href="#HomotopyContinuation.AbstractSystemCache"><code>HomotopyContinuation.AbstractSystemCache</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">AbstractSystemCache</code></pre><p>A cache to avoid allocations for the evaluation of an <a href="#HomotopyContinuation.AbstractSystem"><code>AbstractSystem</code></a>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.SystemNullCache" href="#HomotopyContinuation.SystemNullCache"><code>HomotopyContinuation.SystemNullCache</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">SystemNullCache</code></pre><p>An empty cache if no cache is necessary.</p></div></div></section><h3><a class="nav-anchor" id="Mandatory-1" href="#Mandatory-1">Mandatory</a></h3><p>The following methods are mandatory to implement.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.cache-Tuple{AbstractSystem,Vararg{Any,N} where N}" href="#HomotopyContinuation.cache-Tuple{AbstractSystem,Vararg{Any,N} where N}"><code>HomotopyContinuation.cache</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">cache(F::AbstractSystem, x)::AbstractSystemCache</code></pre><p>Create a cache for the evaluation (incl. Jacobian) of <code>F</code> with elements of the type of <code>x</code>.</p><pre><code class="language-none">cache(F::AbstractSystem, x, p)::AbstractSystemCache</code></pre><p>Create a cache for the evaluation (incl. Jacobian) of <code>F</code> with elements of the type of <code>x</code> and parameters <code>p</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.evaluate!-Tuple{Any,AbstractSystem,Vararg{Any,N} where N}" href="#HomotopyContinuation.evaluate!-Tuple{Any,AbstractSystem,Vararg{Any,N} where N}"><code>HomotopyContinuation.evaluate!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">evaluate!(u, F::AbstractSystem, x, cache::AbstractSystemCache)</code></pre><p>Evaluate the system <code>F</code> at <code>x</code> and store the result in <code>u</code>.</p><pre><code class="language-none">evaluate!(u, F::AbstractSystem, x, p, cache::AbstractSystemCache)</code></pre><p>Evaluate the system <code>F</code> at <code>x</code> and parameters <code>p</code> and store the result in <code>u</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.evaluate" href="#HomotopyContinuation.evaluate"><code>HomotopyContinuation.evaluate</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">evaluate(F::AbstractSystem, x::AbstractVector, cache=cache(F, x))</code></pre><p>Evaluate the system <code>F</code> at <code>x</code>.</p><pre><code class="language-none">evaluate(F::AbstractSystem, x::AbstractVector, p, cache=cache(F, x))</code></pre><p>Evaluate the system <code>F</code> at <code>x</code> and parameters <code>p</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.jacobian!-Tuple{Any,AbstractSystem,Vararg{Any,N} where N}" href="#HomotopyContinuation.jacobian!-Tuple{Any,AbstractSystem,Vararg{Any,N} where N}"><code>HomotopyContinuation.jacobian!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">jacobian!(u, F::AbstractSystem, x , cache::AbstractSystemCache)</code></pre><p>Evaluate the Jacobian of the system <code>F</code> at <code>x</code> and store the result in <code>u</code>.</p><pre><code class="language-none">jacobian!(u, F::AbstractSystem, x , p, cache::AbstractSystemCache)</code></pre><p>Evaluate the Jacobian of the system <code>F</code> at <code>x</code> and parameters <code>p</code> and store the result in <code>u</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.jacobian" href="#HomotopyContinuation.jacobian"><code>HomotopyContinuation.jacobian</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">jacobian(F::AbstractSystem, x, cache=cache(F, x))</code></pre><p>Evaluate the Jacobian of the system <code>F</code> at <code>x</code>.</p><pre><code class="language-none">jacobian(F::AbstractSystem, x , p, cache=cache(F, x))</code></pre><p>Evaluate the Jacobian of the system <code>F</code> at <code>x</code> and parameters <code>p</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.size-Tuple{AbstractSystem}" href="#Base.size-Tuple{AbstractSystem}"><code>Base.size</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">Base.size(F::AbstractSystem)</code></pre><p>Returns a tuple <code>(m, n)</code> indicating that <code>F</code> is a system of <code>m</code> polynomials <code>m</code> in <code>n</code> variables.</p></div></div></section><p>Additionally if the system should support parameter homotopies it needs to support</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.differentiate_parameters!" href="#HomotopyContinuation.differentiate_parameters!"><code>HomotopyContinuation.differentiate_parameters!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">differentiate_parameters!(u, F::AbstractSystem, x, p, cache::AbstractSystemCache)</code></pre><p>Evaluate the Jacobian of the system <code>F</code> at <code>x</code> and parameters <code>p</code> w.r.t. the parameters and store the result in <code>u</code>.</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.differentiate_parameters" href="#HomotopyContinuation.differentiate_parameters"><code>HomotopyContinuation.differentiate_parameters</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">differentiate_parameters(F::AbstractSystem, x, p, cache=cache(F, x))</code></pre><p>Evaluate the Jacobian of the system <code>F</code> at <code>x</code> and parameters <code>p</code> w.r.t. the parameters</p></div></div></section><h3><a class="nav-anchor" id="Optional-1" href="#Optional-1">Optional</a></h3><p>The following methods are mandatory to implement. The following are optional to implement but usually you want to define at least <a href="#HomotopyContinuation.cache-Tuple{AbstractSystem,Vararg{Any,N} where N}"><code>cache</code></a>.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.evaluate_and_jacobian!-Tuple{Any,Any,AbstractSystem,Any,AbstractSystemCache}" href="#HomotopyContinuation.evaluate_and_jacobian!-Tuple{Any,Any,AbstractSystem,Any,AbstractSystemCache}"><code>HomotopyContinuation.evaluate_and_jacobian!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">evaluate_and_jacobian!(u, U, F, x , cache::AbstractSystemCache)</code></pre><p>Evaluate the system <code>F</code> and its Jacobian at <code>x</code> and store the results in <code>u</code> (evalution) and <code>U</code> (Jacobian).</p></div></div></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="HomotopyContinuation.evaluate_and_jacobian!-Tuple{Any,Any,AbstractSystem,Any,Any,AbstractSystemCache}" href="#HomotopyContinuation.evaluate_and_jacobian!-Tuple{Any,Any,AbstractSystem,Any,Any,AbstractSystemCache}"><code>HomotopyContinuation.evaluate_and_jacobian!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-julia">evaluate_and_jacobian!(u, U, F, x, p, cache::AbstractSystemCache)</code></pre><p>Evaluate the system <code>F</code> and its Jacobian at <code>x</code> and parameters <code>p</code> and store the results in <code>u</code> (evalution) and <code>U</code> (Jacobian).</p></div></div></section><footer><hr/><a class="previous" href="../predictors-correctors/"><span class="direction">Previous</span><span class="title">Predictors and correctors</span></a><a class="next" href="../norms_distances/"><span class="direction">Next</span><span class="title">Norms and distances</span></a></footer></article></body></html>
